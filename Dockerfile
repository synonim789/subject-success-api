FROM node:lts-alpine

WORKDIR /app

COPY package.json .
COPY package-lock.json .

RUN npm install

COPY . .

ARG PORT
ARG MONGO_URI

# Google Auth
ARG GOOGLE_CLIENT_ID
ARG GOOGLE_CLIENT_SECRET
ARG GOOGLE_REDIRECT_URL

# Github Auth
ARG GITHUB_CLIENT_ID
ARG GITHUB_CLIENT_SECRET

# MailTrap
ARG MAILTRAP_USER
ARG MAILTRAP_PASSWORD

# Cloudinary
ARG CLOUDINARY_CLOUD_NAME
ARG CLOUDINARY_API_KEY
ARG CLOUDINARY_API_SECRET


EXPOSE 3000

RUN npm run build

CMD ["npm", "run", "start:production"]